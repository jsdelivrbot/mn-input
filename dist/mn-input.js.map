{"version":3,"sources":["/sources/scripts/mn-input.class.js"],"names":["MnInput","self","notImplemented","defaultAttr","attributes","some","attribute","name","setAttribute","attributeSpec","attributeSpecs","filter","spec","isDefaultAttribute","hasOwnProperty","attributeValue","value","isValidValue","values","indexOf","default","input","_this","_ret","_classCallCheck","this","console","log","classList","add","getAttribute","hasValue","undefined","remove","document","createElement","addEventListener","closest","validate","Array","from","map","attr","defaultAttibutes","concat","forEach","removeAttribute","insertBefore","firstChild","_possibleConstructorReturn","querySelector","focus","blur","objectValues","obj","array","key","push","patternMismatch","RegExp","test","rangeOverflow","rangeUnderflow","stepMismatch","errors","required","validity","valueMissing","pattern","Object","invalid","cssClass","HTMLElement","window","customElements","define"],"mappings":"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","file":"mn-input.js","sourcesContent":["class MnInput extends HTMLElement {\n  constructor(self) {\n    self = super(self)\n    console.log('called')\n\n    // set style\n    this.classList.add('mn-input')\n    const value = this.getAttribute('value')\n    const hasValue = value !== null\n      &&  value !== undefined\n      && value !== ''\n\n    hasValue\n      ? this.classList.add('has-value')\n      : this.classList.remove('has-value')\n\n    // // empty element\n    // this.innerHTML = ''\n\n    // set input\n    const attributeSpecs = [\n      {\n        name: 'value',\n      },\n      {\n        name: 'name',\n      },\n      {\n        name: 'autocomplete',\n        default: 'off',\n      },\n      {\n        name: 'autofocus',\n      },\n      {\n        name: 'maxlength',\n      },\n      {\n        name: 'pattern',\n      },\n      {\n        name: 'readonly',\n      },\n      {\n        name: 'required',\n      },\n      {\n        name: 'disabled',\n      },\n      {\n        name: 'autocapitalize',\n      },\n    ]\n\n    const input = document.createElement('input')\n    input.addEventListener('focus', () => this.classList.add('focused'))\n    input.addEventListener('keyup', () => {\n      if (this.closest('form.submitted')) {\n        this.validate()\n      }\n    })\n    input.addEventListener('blur', () => this.classList.remove('focused'))\n    input.addEventListener('change', () => this.value = input.value)\n\n    let attributes = Array\n      .from(this.attributes)\n      .map(attr => {\n        const name = attr.name\n        const value = attr.value\n        return {name, value}\n      })\n\n    let defaultAttibutes = attributeSpecs\n      .filter(attr => attr.hasOwnProperty('default'))\n      .filter(notImplemented)\n\n    attributes = attributes.concat(defaultAttibutes)\n\n    attributes.forEach(setAttribute)\n\n    attributeSpecs\n      .filter(attr => attr.remove)\n      .forEach(attr => {\n        this.removeAttribute(attr.name)\n      })\n\n    this.insertBefore(input, this.firstChild)\n\n    return self\n\n    function notImplemented(defaultAttr) {\n      return !attributes.some(attribute => attribute.name === defaultAttr.name)\n    }\n\n    function setAttribute(attribute) {\n      let attributeSpec = attributeSpecs.filter(spec => spec.name === attribute.name)[0]\n      if (!attributeSpec) {\n        return false\n      }\n      let isDefaultAttribute = attributeSpec.hasOwnProperty('default')\n      let attributeValue = attribute.value\n\n      if (isDefaultAttribute) {\n        let isValidValue = attributeSpec.hasOwnProperty('values')\n          && attributeSpec.values.indexOf(attributeValue) >= 0\n\n        let value = isValidValue\n          ? attributeValue\n          : attributeSpec.default\n\n        input.setAttribute(attribute.name, value)\n      } else if (attributeValue) {\n        input.setAttribute(attribute.name, attributeValue)\n      }\n    }\n  }\n\n  set value(value) {\n    const input = this.querySelector('input')\n    const hasValue = value !== null &&  value !== undefined && value !== ''\n    if (hasValue) {\n      if (input.value !== value) {\n        input.value = value\n      }\n      this.classList.add('has-value')\n    } else {\n      input.value = ''\n      this.classList.remove('has-value')\n    }\n\n    if (input.value !== value && this.closest('form.submitted')) {\n      this.validate()\n    }\n  }\n\n  get value() {\n    const input = this.querySelector('input')\n    return input.value\n  }\n\n  focus() {\n    this.querySelector('input').focus()\n    this.classList.add('focused')\n  }\n\n  blur() {\n    this.querySelector('input').blur()\n    this.classList.remove('focused')\n  }\n\n  validate() {\n    const input = this.querySelector('input')\n\n    if (input) {\n      const patternMismatch = !RegExp(this.getAttribute('pattern') || '').test(input.value)\n      const hasValue = this.value !== ''\n      const rangeOverflow = this.getAttribute('max')\n        ? hasValue && this.value > this.getAttribute('max')\n        : false\n\n      const rangeUnderflow = this.getAttribute('min')\n        ? hasValue && this.value < this.getAttribute('min')\n        : false\n\n      const stepMismatch = this.getAttribute('step')\n        ? hasValue && (this.value % this.getAttribute('step')) !== 0\n        : false\n\n      const errors = {\n        required: input.validity.valueMissing,\n        pattern: patternMismatch,\n        rangeOverflow,\n        rangeUnderflow,\n        stepMismatch,\n      }\n\n      Object.values = Object.values\n        ? Object.values\n        : objectValues\n\n      function objectValues(obj) {\n        const array = []\n        for (const key in obj) {\n          array.push(obj[key])\n        }\n        return array\n      }\n\n      errors.invalid = Object.values(errors).some(value => value)\n\n      for (const key in errors) {\n        const cssClass = key\n        const invalid = errors[key]\n\n        invalid\n          ? this.classList.add(cssClass)\n          : this.classList.remove(cssClass)\n      }\n    }\n  }\n}\n\nwindow.customElements.define('mn-input', MnInput)\n"]}